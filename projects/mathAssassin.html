<html>
<head>
	<title>Math Town</title>
	<script type="text/javascript" src="../lib/phaser/dist/phaser.min.js"></script>
		<script>
			//gamescreen size
			var width = 800;
			var height = 600;
			//image references
			var startButton;
			var plusSign;
			var numberImagesRight = [];
			var numberImagesLeft = [];
			var happyCage;
			var madCage;
			//keyboard reference
			var keyboard;

			//logic variables
		 	var equationRight = 0;
		 	var equationLeft = 0;
		 	var answer;
		 	var createNewEquation = true;
			var currentInput = 0;

			var gameState = 'S'; /*gamestate holds 
			   		       		 'G' - gameloop
			   					 'P' - pause
			   					 'S' - startscreen*/

			var blink = 0;
			var startScreenLoop = function(){
				blink++;
				if(blink > 30){
					startButton.y = -300;
				}
				if(blink > 40){
					blink = 0;
					startButton.y = height/3;
				}
				keyboard.onUpCallback = function(evt){
					if(evt.keyCode === 13){
						startButton.y = -300;
						gameState = 'G';
					}
				}
			}
			var gameLoop = function(){
				plusSign.y = 75;
				//set old images offscreen, bring new ones in
				if(createNewEquation){
					
					numberImagesRight[equationRight].y = -250; //remove old numbers from screen
					numberImagesLeft[equationLeft].y = -250;
					
					equationRight = Math.ceil(Math.random() * 9); //get new numbers
					equationLeft = Math.ceil(Math.random() * 9);
					
					answer = equationRight + equationLeft; 
					
					numberImagesRight[equationRight].y = 50; //move new numbers onto screen
					numberImagesLeft[equationLeft].y = 50;
					
					createNewEquation = false;
				}
			

				keyboard.onUpCallback = function(evt){
					console.log(evt)
					//they enter the right single digit answer
					currentInput += evt.keyCode - 48;
					if(currentInput === answer){
						console.log(currentInput, ' correct');
						happyCage.y = 240;
						madCage.y = -500;
						currentInput = 0;
						createNewEquation = true;
					} else{
						if(currentInput * 10 > answer){
							console.log(currentInput, ' too great');
							madCage.y = 240;
							happyCage.y = -500;
							currentInput = 0;
						}else if(currentInput * 10 <= answer){
							console.log(currentInput, ' still too low');
							currentInput = currentInput * 10;

						}
					}
				}
			}
			var pauseLoop = function(){

			}

			function preload(){
				game.load.image('background', 'mathAssassinImages/background.png');
				game.load.image('0', 'mathAssassinImages/number_0_white.jpg');
				game.load.image('1', 'mathAssassinImages/number_1_white.png');
				game.load.image('2','mathAssassinImages/number_2_white.png');
				game.load.image('3', 'mathAssassinImages/number_3_white.png');
				game.load.image('4', 'mathAssassinImages/number_4_white.png');
				game.load.image('5', 'mathAssassinImages/number_5_white.png');
				game.load.image('6', 'mathAssassinImages/number_6_white.png');
				game.load.image('7', 'mathAssassinImages/number_7_white.png');
				game.load.image('8', 'mathAssassinImages/number_8_white.png');
				game.load.image('9', 'mathAssassinImages/number_9_white.png');
				game.load.image('startButton', 'mathAssassinImages/press_enter.png');
				game.load.image('plus', 'mathAssassinImages/plus.png');
				game.load.image('happy', 'mathAssassinImages/happy_cage.jpg');
				game.load.image('mad', 'mathAssassinImages/mad_cage.jpg');
			}

			function create(){
				game.add.image(-200,-200,'background');
				
				startButton = game.add.image(width/3,height/3,'startButton');
				plusSign = game.add.image(225,-175,'plus');
				equalSign = game.add.iage(400,-175,'equal');
				happyCage = game.add.image(200,-500,'happy');
				madCage = game.add.image(200,-500,'mad');
				numberImagesRight[0] = game.add.image( 350,-250,'0');
				numberImagesRight[1] = game.add.image( 350,-250,'1');
				numberImagesRight[2] = game.add.image( 350,-250,'2');
				numberImagesRight[3] = game.add.image( 350,-250,'3');
				numberImagesRight[4] = game.add.image( 350,-250,'4');
				numberImagesRight[5] = game.add.image( 350,-250,'5');
				numberImagesRight[6] = game.add.image( 350,-250,'6');
				numberImagesRight[7] = game.add.image( 350,-250,'7');
				numberImagesRight[8] = game.add.image( 350,-250,'8');
				numberImagesRight[9] = game.add.image( 350,-250,'9');

				numberImagesLeft[0] = game.add.image(100, -250,'0');
				numberImagesLeft[1] = game.add.image(100, -250,'1');
				numberImagesLeft[2] = game.add.image(100, -250,'2');
				numberImagesLeft[3] = game.add.image(100, -250,'3');
				numberImagesLeft[4] = game.add.image(100, -250,'4');
				numberImagesLeft[5] = game.add.image(100, -250,'5');
				numberImagesLeft[6] = game.add.image(100, -250,'6');
				numberImagesLeft[7] = game.add.image(100, -250,'7');
				numberImagesLeft[8] = game.add.image(100, -250,'8');
				numberImagesLeft[9] = game.add.image(100, -250,'9');

				answerFirst[0] = game.add.image(450,-250,'0');
				answerFirst[1] = game.add.image(450,-250,'1');
				answerFirst[2] = game.add.image(450,-250,'2');
				answerFirst[3] = game.add.image(450,-250,'3');
				answerFirst[4] = game.add.image(450,-250,'4');
				answerFirst[5] = game.add.image(450,-250,'5');
				answerFirst[6] = game.add.image(450,-250,'6');
				answerFirst[7] = game.add.image(450,-250,'7');
				answerFirst[8] = game.add.image(450,-250,'8');
				answerFirst[9] = game.add.image(450,-250,'9');

				answerSecond[0] = game.add.image(560,-250,'0');
				answerSecond[1] = game.add.image(560,-250,'1');
				answerSecond[2] = game.add.image(560,-250,'2');
				answerSecond[3] = game.add.image(560,-250,'3');
				answerSecond[4] = game.add.image(560,-250,'4');
				answerSecond[5] = game.add.image(560,-250,'5');
				answerSecond[6] = game.add.image(560,-250,'6');
				answerSecond[7] = game.add.image(560,-250,'7');
				answerSecond[8] = game.add.image(560,-250,'8');
				answerSecond[9] = game.add.image(560,-250,'9');

				keyboard = game.input.keyboard; 

			}


			
			function update(){
				if(gameState === 'S'){
					return startScreenLoop();
				}
				if(gameState === 'G'){
					return gameLoop();
				}
				if(gameState === 'P'){
					return pauseLoop();
				}
			}

			var game = new Phaser.Game(800, 600, Phaser.AUTO, '', {
				preload: preload, 
				create:create,
				update:update
			});


		</script>
	</head>
	<body>
		<h1>In Development </h1>
		<hr>

	</body>
</body>
</html>